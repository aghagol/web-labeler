<html>
<body>
    <input type='file' onchange='openFile(event)'><br>
    <div id='currentLabel'>Label:</div>
    <input type='button'
        value='1: Positive (researcher homepage/faculty profile)'
        onClick='markLabel(1)'><br>
    <input type='button'
        value='-1: Negative'
        onClick='markLabel(-1)'><br>
    <input type='button'
        value='2: Not in English'
        onClick='markLabel(2)'><br>
    <input type='button'
        value='3: Not Accessible (4XX error)'
        onClick='markLabel(3)'><br>
    <input type='button'
        value='4: Not Sure!'
        onClick='markLabel(4)'><br>
    <div id='currentIndex'>Entry number:</div>
    <input type='button' value='Next' onClick='loadNextPage()'>
    <input type='button' value='Prev' onClick='loadPrevPage()'><br>
    <!-- <input type='button' value='Save' onClick='saveWork()'><br> -->
    <iframe id='iframe'
        width='1000'
        height='1000'
        src='about:blank'>
    </iframe>
    <script>
        // var fs = require('fs');
        var webpageLinks = [];
        var currentIndex = -1;
        var labels = {};
        var openFile = function(event) {
            var reader = new FileReader();
            reader.onload = function(event){
                var text = reader.result;
                webpageLinks = text.split("\n");
                alert('Found ' + webpageLinks.length + ' entries');
                currentIndex = -1;
                loadNextPage();
            };
            reader.readAsText(event.target.files[0]);
        };
        var loadNextPage = function() {
            if (currentIndex < webpageLinks.length - 1) {
                currentIndex++;
                document.getElementById('currentIndex').innerText = 'Entry number: ' + currentIndex;
                document.getElementById('iframe').src = webpageLinks[currentIndex];
            } else {
                alert('Reached end of the list!');
                currentIndex = webpageLinks.length;
            }
        };
        var loadPrevPage = function() {
            if (currentIndex <= 0) {
                alert('At top of the list!');
            } else {
                currentIndex--;
                document.getElementById('currentIndex').innerText = 'Entry number: ' + currentIndex;
                document.getElementById('iframe').src = webpageLinks[currentIndex];
            }
        };
        // var saveWork = function() {
        //     var labelsfilepath = '/home/mo/github/web-labeler/labels.txt';
        //     var labelsfile = fs.openSync(labelsfilepath, 'w');
        //     for (var key in labels) {
        //         fs.writeSync(labelsfile, labels[key] + '\t' + key + '\n');
        //     }
        //     alert('Saved work at ' + labelsfilepath);
        // };
        var markLabel = function(label) {
            labels[webpageLinks[currentIndex]] = label;
            document.getElementById('currentLabel').innerText = 'Label: ' + label;
        };
    </script>
</body>
</html>
